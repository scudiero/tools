//======================================================================================================================
// version:1.0.25 // -- dscudiero -- Tue 10/03/2017 @  8:58:29.10
//======================================================================================================================
// ??/??/?? - dgs - Initial
// 08/08/17 - dgs - Added AcadLevel and refactored wforder
//======================================================================================================================
// Form fields referenced:
//		code
//		allcodes
//		subject
//		department
//		college
//		course_number
//======================================================================================================================

// Set debug environments, any comma separated combination of 'dev','test','next'. e.g. debugEnvs:dev,test
wfDebugEnvs:dev,test
wfAddSisEnvs:test,next
//skiploadsync:true; //Turn off SIS Syncing

// Set debug message level, integer 0-10
// msgLevel = 0, no messages
//			  1, Messages from functions in workflowFuncs atj
//			  2, Messages from utility functions in workflowFuncs atj
//			  3, Messages from functions in workflowLib atj
//			  4, More detail from functions in workflowLib atj
wfDebugLevel:1

//======================================================================================================================
//wfcomments = 'all', 'workflow', or some RegEx against the roles.  e.g. 'wfcomments: fyi(all)?$'
//or 'wfcomments: Committee$'
//======================================================================================================================
wfcomments:

//======================================================================================================================
// Define which variables are substituted -- used by getCimRoles script
//======================================================================================================================
wfSubRule:Cols|SELECT code,name,access FROM codedesc WHERE setname="college" and rank >= 0 and (access <> 'retired' OR access IS NULL) order by code
wfSubRule:Depts|SELECT code,name,access FROM codedesc WHERE setname="department" and rank >= 0 and (access <> 'retired' OR access IS NULL) order by code
wfSubRule:Subjs|SELECT code,name,access FROM codedesc WHERE setname="subject" and rank >= 0 and (access <> 'retired' OR access IS NULL) order by code

//======================================================================================================================
// Substitution variables
//======================================================================================================================
// Add tcfonly=true; to only substitute the tcf data
//======================================================================================================================
wfrules:Cols|function|wfAttr|; //Substitutes the value(s) for'college' resolved through allcodes
wfrules:Depts|function|wfAttr|; //Substitutes the value(s) for 'department' resolved through allcodes
wfrules:Subjs|function|wfAttr|; //Substitutes the value(s) for 'subject' resolved through allcodes

//==================================================================================================
//Configure Voteing
//==================================================================================================
//voteshowfullresults:true
//votesuccesspct:70%
//voterules:FA_Council_vote|FA Council Vote|7|votepasspct=75%;
//          A              A               A             A
//          |              |               |             |
//          |              |               |             +----  51% of the votes cast have to be yes.
//          |              |               +------- This is the number of days the voting window remains open, 0 means until vote is a success
//          |              +-- This is the 'REAL' RESOLVED name of the voting step
//e.g.
//voterules:facultyVote| Faculty Vote|0|voteshowfullresults:true;votesuccesspct:total;votepasspct:51%

//======================================================================================================================
// Parallel workflow (esigs) definitions
//esiglist:UCCGC|UCC/GC|function|UCCGCesig;
//esiglist:GCCFS|GC/FS|function|GCFSesig;

//======================================================================================================================
// 'Standard' conditionals
//======================================================================================================================
// Add |tcfonly=true; to only substitute the tcf data
//======================================================================================================================
wfrules:isNew|iffieldmatch|newrecord|value=true; //Proposal for a new course
wfrules:isNotNew|function|IsNotNew|; //Proposal is not for a new course
wfrules:isEdit|function|IsEdit|; //Proposal to modify an existing course
wfrules:isNotEdit|iffieldmatch|newrecord|value=true; //Proposal is not Edit
wfrules:isNotEdit|iffieldmatch|deleterec|value=true; //Proposal is not Edit
wfrules:isDelete|iffieldmatch|deleterec|value=true; //Proposal to delete an existing course
wfrules:isNotDelete|function|IsNotDelete|; //Proposal is not for a course deletion

//======================================================================================================================
// 'Custom' iffieldmatch conditionals
//======================================================================================================================
wfUgRe:^[0-4]\d{2}\w{0,2}$
wfGrRe:^[5-9]\d{2}\w{0,2}$

wfrules:isUndergraduate|function|CheckAcadLevel|course_number,wfUgRe; //Proposal for an Undergraduate course
wfrules:isGraduate|function|CheckAcadLevel|course_number,wfGrRe; //Proposal for an Graduate course
wfrules:AcadLevel|function|GetAcadLevel|course_number,wfUgRe,UG,wfGrRe,GR; //Returns the academic level, 'UG' or 'GR'

//wfrules:conditionalName|iffieldmatch|variableName.code|value=/^(val1 %7C val2 %7C val3)$/; //Proposal for

//======================================================================================================================
// 'Custom' Workflow function bindings
//======================================================================================================================

//======================================================================================================================
// 'Standard' Workflow function bindings
//======================================================================================================================
wfrules:RelatedDepts|function|RelatedDepts|; //Standard (core) RelatedDepts
wfrules:ProposalState|function|ProposalState|; //Substitute proposal state for workflow selection
wfrules:AddSisStep|function|AddSisStep|; //Add the SIS step as defined in cimconfig.cfg
wfrules:TODO|function|TODO|; //Put a TODO message to the preview workflow screen
wfrules:NoWorkflow|function|NoWorkflow|; //There is insufficient data to calculate workflow

//======================================================================================================================
// Related and Associated steps
//	_formFieldVars
// 		The formate is name[|format][|dataAttributeName] where :
// 		format is one item in the set {courseCode,colCode,deptCode,subjCode}, the default is 'code'
// 		dataAttributeName is the name of the object attribute that contains the data for the reference, default is 'data'
//======================================================================================================================
// Setup rules for non-controlling entities, steps give for each
//
// Related_ecoSystemData:true
// Related_ecoSystemDataFyi:true
//
// wfrules:RelatedAndCrosslistedCols|function|Related|; //Includes steps with departments from the Courseleaf eco-system and any 'related' data from the form
// RelatedAndCrosslistedCols_formFieldVars:crosslisted|courseCode|code
//
// wfrules:RelatedAndCrosslistedDepts|function|Related|; //Includes steps with departments from the Courseleaf eco-system and any 'related' data from the form
// RelatedAndCrosslistedDepts_formFieldVars:crosslisted|courseCode|code
//
// wfrules:RelatedAndCrosslistedSubjs|function|Related|; //Includes steps with subjects from the Courseleaf eco-system and any 'related' data from the form
// RelatedAndCrosslistedSubjs_ecoSystemData:false
// RelatedAndCrosslistedSubjs_ecoSystemDataFyi:false
// RelatedAndCrosslistedSubjs_formFieldVars:crosslisted|courseCode|code

//======================================================================================================================
// Special service wfrules
//======================================================================================================================
//wfrules:WhatsChanged|function|WhatsChanged|; //Show what has changed
//wforder:WhatsChanged
//wfrules:wfDumpVars|function|wfDumpVars|cl_subject,other_depts,sponsors
//wforder:wfDumpVars

//======================================================================================================================
// Workflow selection order, first to last
//======================================================================================================================
wforder:Subjs AcadLevel ProposalState
wforder:Subjs AcadLevel
wforder:Subjs ProposalState
wforder:Subjs standard

wforder:Depts AcadLevel ProposalState
wforder:Depts AcadLevel
wforder:Depts ProposalState
wforder:Depts standard

wforder:Cols AcadLevel ProposalState
wforder:Cols AcadLevel
wforder:Cols ProposalState
wforder:Cols standard

wforder:AcadLevel ProposalState standard
wforder:AcadLevel standard
wforder:ProposalState standard
wforder:standard

//======================================================================================================================
// Check-in log
//======================================================================================================================
// 08-08-2017 @ 10.53.28 - (41.16)     - dscudiero - Refactored wforder
// 08-08-2017 @ 16.31.15 - (35.19)     - dscudiero - misc updates
// 08-09-2017 @ 14.42.37 - (06.84)     - dscudiero - General syncing of dev to prod
// 08-23-2017 @ 10.33.36 - (20.74)     - dscudiero - removed client specific records
// 08-24-2017 @ 10.03.08 - (20.74)     - dscudiero - 
// 08-24-2017 @ 10.03.20 - (20.74)     - dscudiero - General syncing of dev to prod
// 08-25-2017 @ 10.57.35 - (30.19)     - dscudiero - Added the Form fields referenced section
// 08-28-2017 @ 11.41.49 - (29.48)     - dscudiero - Add TODO
// 09-06-2017 @ 07.26.03 - (28.78)     - dscudiero - Add example of voting record
// 09-11-2017 @ 15.51.46 - (28.78
)    - dscudiero - General syncing of dev to prod
// 09-22-2017 @ 12.14.55 - (19.78)     - dscudiero - Added NoWorkflow
// 10-03-2017 @ 10.07.30 - (29.10)     - dscudiero - Updated Vote example to remove blanks after the ';'s
